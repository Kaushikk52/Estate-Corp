
<app-navbar></app-navbar>

<div class="container-fluid h-100">
  <div class="row h-100">
    <!-- Sidebar -->
    <nav id="sidebar" class="col-2 col-md-3 col-lg-2 bg-dark sidebar">
      <div class="position-sticky">
        <!-- <div class="sidebar-header text-center my-3">
                  <h3 class="text-light">Odama Studio</h3>
                  <p class="text-muted">Premium</p>
              </div> -->
        <ul class="nav flex-column">
          <li class="nav-item ">
            
        
            <a class="nav-link text-light" href="#">Home</a>
          </li>
          <li class="nav-item">
            <a class="nav-link text-light" href="#">Contacts</a>
          </li>
          <li class="nav-item">
            <a class="nav-link active" href="#">Property Listings</a>
          </li>
          <li class="nav-item">
            <a class="nav-link text-light" href="#">Profile</a>
          </li>
          <li class="nav-item">
            <a class="nav-link text-light" href="#">User Listings</a>
          </li>
          <li class="nav-item">
            <a class="nav-link text-light" href="#">My Team</a>
          </li>
          <li class="nav-item">
            <a class="nav-link text-light" href="#">Products</a>
          </li>
          <li class="nav-item">
            <a class="nav-link text-light" href="#">Billing</a>
          </li>
        </ul>
      </div>
    </nav>

    <!-- Main Content -->
    <main class="col col-md-9 ms-sm-auto col-lg-10 px-md-4">
      <div
        class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3"
      >
        <h1 class="h2">Listing</h1>
      </div>

      <!-- Listing Filters -->
      <div class="btn-group mb-3" role="group">
        <button type="button" class="btn btn-outline-secondary">
          For Sale (68)
        </button>
        <button type="button" class="btn btn-outline-secondary">
          For Rent (18)
        </button>
        <button type="button" class="btn btn-outline-secondary">
          Sold (36)
        </button>
      </div>

      <!-- Search Bar -->
      <div class="search-bar">
        <img src="../../../assets/icons/search.svg" alt="" class="icons" />
        <input
          type="text"
          placeholder="Search for a property..."
          class="search-input"
          [(ngModel)]="searchText"
        />
      </div>

      <div class="row">
        <div class="col-12 col-lg-8">
          <!-- properties stats -->
          <div class="row mb-4">
            <div class="col-md-4">
              <div class="card card-property p-3">
                <h6>Total Properties</h6>
                <h3>320</h3>
                <span class="text-success">+15.07%</span>
              </div>
            </div>
            <div class="col-md-4">
              <div class="card card-property p-3">
                <h6>Properties Rented</h6>
                <h3>56</h3>
                <span class="text-danger">-24.51%</span>
              </div>
            </div>
            <div class="col-md-4">
              <div class="card card-property p-3">
                <h6>Properties Sold</h6>
                <h3>72</h3>
                <span class="text-success">+12.60%</span>
              </div>
            </div>
          </div>

          <!-- User added properties -->
          <h5>My units <span class="text-muted">(View All)</span></h5>
          <div class="row">
            <!-- Property Card 1 -->
            <div class="col-md-4">
              <div class="card card-property">
                <img
                  src="../../../assets/card/card-images-2.jpg"
                  alt="Property 1"
                />
                <div class="p-3">
                  <h6>
                    $8,720.00
                    <span class="badge bg-success status-badge">For Sale</span>
                  </h6>
                  <p>Davila Residences Batu</p>
                  <small class="text-muted">4 Beds | 2 Baths | 500 m²</small>
                </div>
              </div>
            </div>
            <!-- Property Card 2 -->
            <div class="col-md-4">
              <div class="card card-property">
                <img
                  src="../../../assets/card/card-images-2.jpg"
                  alt="Property 2"
                />
                <div class="p-3">
                  <h6>
                    $4,310.00
                    <span class="badge bg-warning status-badge">Rented</span>
                  </h6>
                  <p>Madura Cabin & Residences</p>
                  <small class="text-muted">2 Beds | 1 Baths | 300 m²</small>
                </div>
              </div>
            </div>
            <!-- Property Card 3 -->
            <div class="col-md-4">
              <div class="card card-property">
                <img
                  src="../../../assets/card/card-images-2.jpg"
                  alt="Property 3"
                />
                <div class="p-3">
                  <h6>
                    $3,680.00
                    <span class="badge bg-danger status-badge">Sold</span>
                  </h6>
                  <p>Aubert & Collins Villas</p>
                  <small class="text-muted">3 Beds | 2 Baths | 400 m²</small>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- side-panel island -->
        <div class="col-12 col-lg-4">
          <div class="card">
            <div class="card-header">
              <h6>Messages <span class="text-muted">(View All)</span></h6>
            </div>


            <div class="card-body" *ngFor="let user of filterUsers();let i = index">
              <div class="message-item">
                <div>
                  <img
                    src="path/to/user1.jpg"
                    alt="user {{i+1}}"
                    class="rounded-circle"
                    width="30"
                  />
                  <span class="ms-2">{{user.fullName}}</span>
                </div>
                <small class="text-muted">{{user.email}} | {{user.contactNo}}</small>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="mt-4 my-table">
        <h5 class="mt-4">Properties</h5>
        <table class="table table-striped table-hover mb-0">
          <thead>
            <tr>
              <th scope="col">#</th>
              <th scope="col">Owner Name</th>
              <th scope="col">Property Id</th>
              <th scope="col">Name</th>
              <th scope="col">Type</th>
              <!-- <th scope="col">Option</th> -->
              <th scope="col">City</th>
              <th scope="col">Locality</th>
              <th scope="col" colspan="3">Action</th>
            </tr>
          </thead>
          <tbody>
            <ng-container *ngIf="searchText; else originalProperties">
              <tr *ngFor="let property of filterProperties(); let i = index">
                <th scope="row">{{ i + 1 }}</th>
                <td>{{ property.propertyOwner }}</td>
                <td>{{ property.propertyId }}</td>
                <td>{{ property.propertyName }}</td>
                <td>{{ property.propertyType }}</td>
                <!-- <td>{{property.propertyOption}}</td>  -->
                <td>{{ property.city }}</td>
                <td>{{ property.locality }}</td>
                <td>
                  <button
                  class="view"
                  (click)="viewProperty(property.propertyId)"
                >
                  View
                </button>
                </td>
                <td>
                <Button
                  class="approve"
                  (click)="
                    toggleApproval(property.propertyId, property.isApproved)
                  "
                >
                  {{ property.isApproved ? "Unapprove" : "Approve" }}
                </Button>
              </td>
              <td><Button class="delete">Delete</Button></td> 
                <!-- <td><Button class="edit">Edit</Button></td> -->
              </tr>
            </ng-container>
            <ng-template #originalProperties>
              <tr *ngFor="let property of properties; let i = index">
                <th scope="row">{{ i + 1 }}</th>
                <td>{{ property.propertyOwner }}</td>
                <td>{{ property.propertyId }}</td>
                <td>{{ property.propertyName }}</td>
                <td>
                  {{
                    property.propertyType === "1"? "Residential Buy" :
                    property.propertyType === "2" ? "Residential Rent" :
                    property.propertyType === "3" ? "Commercial Buy" :
                    property.propertyType === "4" ? "Commercial Rent" :
                    "Type Not Set"
                  }}
                </td>
                <!-- <td>{{property.propertyOption}}</td>  -->
                <td>{{ property.city }}</td>
                <td>{{ property.locality }}</td>
                <td><Button class="view">View</Button></td>
                <td>
                  <Button
                    class="approve"
                    (click)="
                      toggleApproval(property.propertyId, property.isApproved)
                    "
                  >
                    {{ property.isApproved ? "Unapprove" : "Approve" }}
                  </Button>
                </td>
                <td><Button class="delete">Delete</Button></td> 
                <!-- <td><Button class="edit">Edit</Button></td> -->
              </tr>
            </ng-template>
          </tbody>
        </table>
        <app-alert-popup
          *ngIf="showApprovalAlert"
          [message]="'Property Approved'"
        ></app-alert-popup>
        <app-alert-popup
          *ngIf="showUnapprovalAlert"
          [message]="'Property Unapproved'"
        ></app-alert-popup>
      </div>
    </main>
  </div>
</div>
